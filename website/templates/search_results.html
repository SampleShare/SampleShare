{% extends "base.html" %}

{% block content %}
<h2>Search Results for "{{ query }}"</h2>

<!-- Filter Form -->
<form id="filter-form">
    <label>
        <input type="radio" name="filter" value="username" checked> Username
    </label>
    <label>
        <input type="radio" name="filter" value="sample"> Sample
    </label>
</form>

<!-- Search Results -->
<div id="results-container">
    {% if users %}
        <ul>
            {% for user in users %}
                <li>
                    <a href="{% url 'profile' user.username %}">{{ user.username }}</a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No users found matching "{{ query }}".</p>
    {% endif %}
</div>

<!-- JavaScript for Dynamic Filtering -->
<script>
    // Add the event listener to the filter radio buttons
    document.querySelectorAll('input[name="filter"]').forEach((radio) => {
        radio.addEventListener('change', function () {
            const filterValue = this.value;
            const searchQuery = "{{ query }}"; // Use the current search query value from Django template
            
            // Fetch filtered results dynamically
            fetch(`/search?query=${searchQuery}&filter=${filterValue}`)
                .then(response => response.text())
                .then(data => {
                    // Update the results container with the new HTML content
                    document.getElementById('results-container').innerHTML = data;
                });
        });
    });
</script>
{% endblock %}
